use strict;
use DBI;

# To call the main() method
&main();

#Define main() method
sub main()
{
	&InitDB();	# To call the InitDB() method

	&cleanUpDb();	# To call the cleanUpDb() method
}
	# InitDB() method is used for to connect the database
	sub InitDB()
	{
		
	# Get the mysql database connection 
	my $dbh=DBI->connect('DBI:mysql:localdb','root','root123') or die "Could not Connect to the mysql database please check the crdentials".DBI->errstr;
	
	my %hash = (EmpId  => 38,EmpName  => 'kiran',EmpAge => 29,EmpDept => 'admin',);
	
	my $keystr = (join ",\n        ", (keys %hash));
	
	my $valstr = join ', ', (split(/ /, "? " x (scalar(values %hash))));
	
	my @values = values %hash;

	
	&Insert();	# To call the Insert() method

	#Insert() method is used for insert the data into the database.
	sub Insert()
	{
		my $query = qq`insert into employee ( $keystr ) values ($valstr )`;
		my $sth = $dbh->prepare($query) or die "Can't prepare insert: ".$dbh->errstr()."\n";
		$sth->execute(@values) or die "Can't execute insert: ".$dbh->errstr()."\n";
		print "insert data into database \n";
		
		$sth->finish();
	}
	
	# cleanUpDb() method used for close the connection
	sub cleanUpDb()
	{
		# close the connection
		$dbh->disconnect;
	}
}




