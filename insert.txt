use strict;
use DBI;

# To call the main() method
&main();

#Define main() method
sub main()
{
	&InitDB();	   # To call the InitDB() method
	&Insert();	   # To call the Insert() method
	&cleanUpDb();  # To call the cleanUpDb() method
}

my $dbh;

# InitDB() method is used for to connect the database
sub InitDB()
{
		
	# Get the mysql database connection 
	 $dbh=DBI->connect('DBI:mysql:localdb','root','root123') or die "Could not Connect to the mysql database please check the crdentials".DBI->errstr;
	
}

#Insert() method is used for insert the data into the database.
sub Insert()
{
		#To Initialize the key and value pairs
		my %hash = (EmpId  => 38,EmpName  => 'kiran',EmpAge => 29,EmpDept => 'admin',);
		my $keystr = (join ",\n        ", (keys %hash));
		my $valstr = join ', ', (split(/ /, "? " x (scalar(values %hash))));
		my @values = values %hash;

		# insert data into the employee table
		my $query = qq`insert into employee ( $keystr ) values ($valstr )`;
		my $sth = $dbh->prepare($query) or die "Can't prepare insert: ".$dbh->errstr();
			
		# execute the query
		$sth->execute(@values) or die "Can't execute insert: ".$dbh->errstr();
		print "inserted data into database \n";
		
		$sth->finish();
}
	
# cleanUpDb() method used for close the connection
sub cleanUpDb()
{
	if(defined $dbh)
	{	
	# close the connection
	$dbh->disconnect;
	}
	else
	{
		print"Connection closed";
	}

	
}




